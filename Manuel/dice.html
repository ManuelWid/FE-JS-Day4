<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <style>
        img{
            width: 250px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header text-center">
            <h2 id="versus"></h2>
        </div>

        <div class="d-flex">
            <div id="left" class="w-50 d-flex flex-column align-items-center mt-5">
                <img src="dice1.png" id="dice1">
                <button id="left-btn" class="btn-lg roll-dice mt-5">Roll the Dice</button>
            </div>
            <div id="right" class="w-50 d-flex flex-column align-items-center mt-5">
                <img src="dice1.png" id="dice2">
                <button id="right-btn" class="btn-lg roll-dice mt-5">Roll the Dice</button>
            </div>
        </div>
        
        <div class="d-flex align-items-center mt-3 flex-column">
            <h4 id="warning"></h4>
            <button id="restart" style="display: none;" class="btn-lg">Restart</button>
        </div>
    </div>
    
    <script>
        const versusHead = document.getElementById("versus");
        const infoBox = document.getElementById("warning");
        document.getElementById("restart").addEventListener("click", gameRestart)
        let player1 = prompt("Enter player one name", "Player1");
        let player2 = prompt("Enter player two name", "Player2");
        // let player1 = "one";
        // let player2 = "two";
        if(player1 === null){player1 = "Good"}
        if(player2 === null){player2 = "Evil"}
        versusHead.innerHTML = `${player1} VS. ${player2}`;

        let p1roll = 0;
        let p2roll = 0;

        let gameEnd = 0;

        let temp = "";
        let timer = "";
        let carry = "";

        const rollBtns = document.getElementsByClassName("roll-dice");
        for(let i = 0; i < rollBtns.length; i++){
            rollBtns[i].addEventListener("click", rollDice);
        };

        function rollDice(){
            let player = this.id;
            // console.log(player);
            let randomNum = Math.floor(Math.random() * 6)+1;
            if(gameEnd == 0){
                if(player == "left-btn"){
                if(p1roll == 0){
                    p1roll = randomNum;
                    console.log(p1roll);
                    spinTime(1000);
                    carry = "dice1";
                    document.getElementById("right-btn").disabled = true;
                    console.log("disabled rights");
                    // setDice("dice1");
                    infoBox.innerHTML = "";
                    if(p2roll != 0){
                        gameEndFunc();
                    }
                }
                else{
                    infoBox.innerHTML = "Wait for player 2";
                }
                }else{
                    if(p2roll == 0){
                        p2roll = randomNum;
                        console.log(p2roll);
                        spinTime(1000);
                        carry = "dice2";
                        document.getElementById("left-btn").disabled = true;
                        console.log("disabled left");
                        // setDice("dice2");
                        infoBox.innerHTML = "";
                        if(p1roll != 0){
                            gameEndFunc();
                        }
                    }
                    else{
                        infoBox.innerHTML = "Wait for player 1";
                    }
                }
            }
        }

        function setDice(dice){
            let diceSide = document.getElementById(dice);
            if(dice == "dice1"){
                diceSide.setAttribute("src",`dice${p1roll}.png`);
            }
            else{
                diceSide.setAttribute("src",`dice${p2roll}.png`);
            }
        }

        function gameEndFunc(){
            gameEnd = 1;
            let result = 0;
            if(p1roll > p2roll){
                result = "Player 1 wins!"
            }
            else{
                if(p2roll > p1roll){
                result = "Player 2 wins!"
                }
                else{
                    result = "Draw!"
                }
            }
            infoBox.innerHTML = result;
            document.getElementById("restart").style.display = "block";
        }

        // function gameRestart(){
        //     document.getElementById("restart").style.display = "none";
        //     infoBox.innerHTML = "";
        //     p1roll = 0;
        //     p2roll = 0;
        //     carry = "";
        //     gameEnd = 0;
        //     document.getElementById("dice1").setAttribute("src", "dice1.png");
        //     document.getElementById("dice2").setAttribute("src", "dice1.png");
        // }

        function gameRestart(){
            location.reload();
        }
        
        function spinTime(time){
            temp = setInterval(spin, 50);
            timer = setTimeout(stop, time);
        }

        function spin(){
            let ranNum = Math.floor(Math.random() * 6)+1;
            let dice = document.getElementById(carry);
            dice.setAttribute("src", `dice${ranNum}.png`);
        }

        function stop(){
            clearInterval(temp);
            clearTimeout(timer);
            setDice(carry);
            console.log("stop");
            if(carry == "dice1"){
                document.getElementById("right-btn").disabled = false;
                console.log("something");
            }
            else{
                document.getElementById("left-btn").disabled = false;
            }
            
        }
    </script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
</body>
</html>